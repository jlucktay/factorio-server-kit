{
  "variables": {
    "image_name": "packer-{{ isotime \"20060102-150405\" }}"
  },
  "builders": [
    {
      "image_description": "https://github.com/jlucktay/factorio-workbench - baked with Packer {{ packer_version }}",
      "image_family": "packtorio",
      "image_name": "{{ user `image_name` }}",
      "machine_type": "n2-standard-2",
      "preemptible": true,
      "project_id": "jlucktay-factorio",
      "service_account_email": "factorio-server@jlucktay-factorio.iam.gserviceaccount.com",
      "source_image": "ubuntu-1804-bionic-v20191113",
      "ssh_username": "packer",
      "tags": [
        "ssh"
      ],
      "type": "googlecompute",
      "zone": "europe-west1-c"
    }
  ],
  "provisioners": [
    {
      "execute_command": "sudo sh -c '{{ .Vars }} {{ .Path }}'",
      "script": "{{ template_dir }}/provisioner.sh",
      "type": "shell"
    }
  ],
  "post-processors": [
    {
      "environment_vars": [
        "IMAGE_NAME={{ user `image_name` }}"
      ],
      "script": "{{ template_dir }}/create-instance-template.sh",
      "type": "shell-local"
    }
  ]
}
